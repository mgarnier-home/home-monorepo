name: "Build app"
description: "Build the app passed as input"
inputs:
  app-name:
    required: true
    description: "The name of the application to build"
  version:
    required: true
    description: "Version to build"
  platform:
    required: true
    description: "Platform to build for"
  dockerhub-username:
    required: true
    description: "Docker Hub username"
  dockerhub-token:
    required: true
    description: "Docker Hub token"

runs:
  using: "composite"
  steps:
    - name: Login to Docker Hub
      uses: docker/login-action@v3
      with:
        username: ${{ inputs.dockerhub-username }}
        password: ${{ inputs.dockerhub-token }}
    - name: Build application
      shell: bash
      run: bash build-app.sh ${{ inputs.app-name }} ${{ inputs.version }}
    - name: Push application runtime
      shell: bash
      run: docker push mgarnier11/${{ inputs.app-name }}:${{ inputs.platform }}
